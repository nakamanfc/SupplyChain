{"ast":null,"code":"\"use strict\"; // Copyright (C) 2016 Dmitry Chestnykh\n// MIT License. See LICENSE file for details.\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * Package poly1305 implements Poly1305 one-time message authentication algorithm.\n */\n\nvar constant_time_1 = require(\"@stablelib/constant-time\");\n\nvar wipe_1 = require(\"@stablelib/wipe\");\n\nexports.DIGEST_LENGTH = 16; // Port of Andrew Moon's Poly1305-donna-16. Public domain.\n// https://github.com/floodyberry/poly1305-donna\n\n/**\n * Poly1305 computes 16-byte authenticator of message using\n * a one-time 32-byte key.\n *\n * Important: key should be used for only one message,\n * it should never repeat.\n */\n\nvar Poly1305 =\n/** @class */\nfunction () {\n  function Poly1305(key) {\n    this.digestLength = exports.DIGEST_LENGTH;\n    this._buffer = new Uint8Array(16);\n    this._r = new Uint16Array(10);\n    this._h = new Uint16Array(10);\n    this._pad = new Uint16Array(8);\n    this._leftover = 0;\n    this._fin = 0;\n    this._finished = false;\n    var t0 = key[0] | key[1] << 8;\n    this._r[0] = t0 & 0x1fff;\n    var t1 = key[2] | key[3] << 8;\n    this._r[1] = (t0 >>> 13 | t1 << 3) & 0x1fff;\n    var t2 = key[4] | key[5] << 8;\n    this._r[2] = (t1 >>> 10 | t2 << 6) & 0x1f03;\n    var t3 = key[6] | key[7] << 8;\n    this._r[3] = (t2 >>> 7 | t3 << 9) & 0x1fff;\n    var t4 = key[8] | key[9] << 8;\n    this._r[4] = (t3 >>> 4 | t4 << 12) & 0x00ff;\n    this._r[5] = t4 >>> 1 & 0x1ffe;\n    var t5 = key[10] | key[11] << 8;\n    this._r[6] = (t4 >>> 14 | t5 << 2) & 0x1fff;\n    var t6 = key[12] | key[13] << 8;\n    this._r[7] = (t5 >>> 11 | t6 << 5) & 0x1f81;\n    var t7 = key[14] | key[15] << 8;\n    this._r[8] = (t6 >>> 8 | t7 << 8) & 0x1fff;\n    this._r[9] = t7 >>> 5 & 0x007f;\n    this._pad[0] = key[16] | key[17] << 8;\n    this._pad[1] = key[18] | key[19] << 8;\n    this._pad[2] = key[20] | key[21] << 8;\n    this._pad[3] = key[22] | key[23] << 8;\n    this._pad[4] = key[24] | key[25] << 8;\n    this._pad[5] = key[26] | key[27] << 8;\n    this._pad[6] = key[28] | key[29] << 8;\n    this._pad[7] = key[30] | key[31] << 8;\n  }\n\n  Poly1305.prototype._blocks = function (m, mpos, bytes) {\n    var hibit = this._fin ? 0 : 1 << 11;\n    var h0 = this._h[0],\n        h1 = this._h[1],\n        h2 = this._h[2],\n        h3 = this._h[3],\n        h4 = this._h[4],\n        h5 = this._h[5],\n        h6 = this._h[6],\n        h7 = this._h[7],\n        h8 = this._h[8],\n        h9 = this._h[9];\n    var r0 = this._r[0],\n        r1 = this._r[1],\n        r2 = this._r[2],\n        r3 = this._r[3],\n        r4 = this._r[4],\n        r5 = this._r[5],\n        r6 = this._r[6],\n        r7 = this._r[7],\n        r8 = this._r[8],\n        r9 = this._r[9];\n\n    while (bytes >= 16) {\n      var t0 = m[mpos + 0] | m[mpos + 1] << 8;\n      h0 += t0 & 0x1fff;\n      var t1 = m[mpos + 2] | m[mpos + 3] << 8;\n      h1 += (t0 >>> 13 | t1 << 3) & 0x1fff;\n      var t2 = m[mpos + 4] | m[mpos + 5] << 8;\n      h2 += (t1 >>> 10 | t2 << 6) & 0x1fff;\n      var t3 = m[mpos + 6] | m[mpos + 7] << 8;\n      h3 += (t2 >>> 7 | t3 << 9) & 0x1fff;\n      var t4 = m[mpos + 8] | m[mpos + 9] << 8;\n      h4 += (t3 >>> 4 | t4 << 12) & 0x1fff;\n      h5 += t4 >>> 1 & 0x1fff;\n      var t5 = m[mpos + 10] | m[mpos + 11] << 8;\n      h6 += (t4 >>> 14 | t5 << 2) & 0x1fff;\n      var t6 = m[mpos + 12] | m[mpos + 13] << 8;\n      h7 += (t5 >>> 11 | t6 << 5) & 0x1fff;\n      var t7 = m[mpos + 14] | m[mpos + 15] << 8;\n      h8 += (t6 >>> 8 | t7 << 8) & 0x1fff;\n      h9 += t7 >>> 5 | hibit;\n      var c = 0;\n      var d0 = c;\n      d0 += h0 * r0;\n      d0 += h1 * (5 * r9);\n      d0 += h2 * (5 * r8);\n      d0 += h3 * (5 * r7);\n      d0 += h4 * (5 * r6);\n      c = d0 >>> 13;\n      d0 &= 0x1fff;\n      d0 += h5 * (5 * r5);\n      d0 += h6 * (5 * r4);\n      d0 += h7 * (5 * r3);\n      d0 += h8 * (5 * r2);\n      d0 += h9 * (5 * r1);\n      c += d0 >>> 13;\n      d0 &= 0x1fff;\n      var d1 = c;\n      d1 += h0 * r1;\n      d1 += h1 * r0;\n      d1 += h2 * (5 * r9);\n      d1 += h3 * (5 * r8);\n      d1 += h4 * (5 * r7);\n      c = d1 >>> 13;\n      d1 &= 0x1fff;\n      d1 += h5 * (5 * r6);\n      d1 += h6 * (5 * r5);\n      d1 += h7 * (5 * r4);\n      d1 += h8 * (5 * r3);\n      d1 += h9 * (5 * r2);\n      c += d1 >>> 13;\n      d1 &= 0x1fff;\n      var d2 = c;\n      d2 += h0 * r2;\n      d2 += h1 * r1;\n      d2 += h2 * r0;\n      d2 += h3 * (5 * r9);\n      d2 += h4 * (5 * r8);\n      c = d2 >>> 13;\n      d2 &= 0x1fff;\n      d2 += h5 * (5 * r7);\n      d2 += h6 * (5 * r6);\n      d2 += h7 * (5 * r5);\n      d2 += h8 * (5 * r4);\n      d2 += h9 * (5 * r3);\n      c += d2 >>> 13;\n      d2 &= 0x1fff;\n      var d3 = c;\n      d3 += h0 * r3;\n      d3 += h1 * r2;\n      d3 += h2 * r1;\n      d3 += h3 * r0;\n      d3 += h4 * (5 * r9);\n      c = d3 >>> 13;\n      d3 &= 0x1fff;\n      d3 += h5 * (5 * r8);\n      d3 += h6 * (5 * r7);\n      d3 += h7 * (5 * r6);\n      d3 += h8 * (5 * r5);\n      d3 += h9 * (5 * r4);\n      c += d3 >>> 13;\n      d3 &= 0x1fff;\n      var d4 = c;\n      d4 += h0 * r4;\n      d4 += h1 * r3;\n      d4 += h2 * r2;\n      d4 += h3 * r1;\n      d4 += h4 * r0;\n      c = d4 >>> 13;\n      d4 &= 0x1fff;\n      d4 += h5 * (5 * r9);\n      d4 += h6 * (5 * r8);\n      d4 += h7 * (5 * r7);\n      d4 += h8 * (5 * r6);\n      d4 += h9 * (5 * r5);\n      c += d4 >>> 13;\n      d4 &= 0x1fff;\n      var d5 = c;\n      d5 += h0 * r5;\n      d5 += h1 * r4;\n      d5 += h2 * r3;\n      d5 += h3 * r2;\n      d5 += h4 * r1;\n      c = d5 >>> 13;\n      d5 &= 0x1fff;\n      d5 += h5 * r0;\n      d5 += h6 * (5 * r9);\n      d5 += h7 * (5 * r8);\n      d5 += h8 * (5 * r7);\n      d5 += h9 * (5 * r6);\n      c += d5 >>> 13;\n      d5 &= 0x1fff;\n      var d6 = c;\n      d6 += h0 * r6;\n      d6 += h1 * r5;\n      d6 += h2 * r4;\n      d6 += h3 * r3;\n      d6 += h4 * r2;\n      c = d6 >>> 13;\n      d6 &= 0x1fff;\n      d6 += h5 * r1;\n      d6 += h6 * r0;\n      d6 += h7 * (5 * r9);\n      d6 += h8 * (5 * r8);\n      d6 += h9 * (5 * r7);\n      c += d6 >>> 13;\n      d6 &= 0x1fff;\n      var d7 = c;\n      d7 += h0 * r7;\n      d7 += h1 * r6;\n      d7 += h2 * r5;\n      d7 += h3 * r4;\n      d7 += h4 * r3;\n      c = d7 >>> 13;\n      d7 &= 0x1fff;\n      d7 += h5 * r2;\n      d7 += h6 * r1;\n      d7 += h7 * r0;\n      d7 += h8 * (5 * r9);\n      d7 += h9 * (5 * r8);\n      c += d7 >>> 13;\n      d7 &= 0x1fff;\n      var d8 = c;\n      d8 += h0 * r8;\n      d8 += h1 * r7;\n      d8 += h2 * r6;\n      d8 += h3 * r5;\n      d8 += h4 * r4;\n      c = d8 >>> 13;\n      d8 &= 0x1fff;\n      d8 += h5 * r3;\n      d8 += h6 * r2;\n      d8 += h7 * r1;\n      d8 += h8 * r0;\n      d8 += h9 * (5 * r9);\n      c += d8 >>> 13;\n      d8 &= 0x1fff;\n      var d9 = c;\n      d9 += h0 * r9;\n      d9 += h1 * r8;\n      d9 += h2 * r7;\n      d9 += h3 * r6;\n      d9 += h4 * r5;\n      c = d9 >>> 13;\n      d9 &= 0x1fff;\n      d9 += h5 * r4;\n      d9 += h6 * r3;\n      d9 += h7 * r2;\n      d9 += h8 * r1;\n      d9 += h9 * r0;\n      c += d9 >>> 13;\n      d9 &= 0x1fff;\n      c = (c << 2) + c | 0;\n      c = c + d0 | 0;\n      d0 = c & 0x1fff;\n      c = c >>> 13;\n      d1 += c;\n      h0 = d0;\n      h1 = d1;\n      h2 = d2;\n      h3 = d3;\n      h4 = d4;\n      h5 = d5;\n      h6 = d6;\n      h7 = d7;\n      h8 = d8;\n      h9 = d9;\n      mpos += 16;\n      bytes -= 16;\n    }\n\n    this._h[0] = h0;\n    this._h[1] = h1;\n    this._h[2] = h2;\n    this._h[3] = h3;\n    this._h[4] = h4;\n    this._h[5] = h5;\n    this._h[6] = h6;\n    this._h[7] = h7;\n    this._h[8] = h8;\n    this._h[9] = h9;\n  };\n\n  Poly1305.prototype.finish = function (mac, macpos) {\n    if (macpos === void 0) {\n      macpos = 0;\n    }\n\n    var g = new Uint16Array(10);\n    var c;\n    var mask;\n    var f;\n    var i;\n\n    if (this._leftover) {\n      i = this._leftover;\n      this._buffer[i++] = 1;\n\n      for (; i < 16; i++) {\n        this._buffer[i] = 0;\n      }\n\n      this._fin = 1;\n\n      this._blocks(this._buffer, 0, 16);\n    }\n\n    c = this._h[1] >>> 13;\n    this._h[1] &= 0x1fff;\n\n    for (i = 2; i < 10; i++) {\n      this._h[i] += c;\n      c = this._h[i] >>> 13;\n      this._h[i] &= 0x1fff;\n    }\n\n    this._h[0] += c * 5;\n    c = this._h[0] >>> 13;\n    this._h[0] &= 0x1fff;\n    this._h[1] += c;\n    c = this._h[1] >>> 13;\n    this._h[1] &= 0x1fff;\n    this._h[2] += c;\n    g[0] = this._h[0] + 5;\n    c = g[0] >>> 13;\n    g[0] &= 0x1fff;\n\n    for (i = 1; i < 10; i++) {\n      g[i] = this._h[i] + c;\n      c = g[i] >>> 13;\n      g[i] &= 0x1fff;\n    }\n\n    g[9] -= 1 << 13;\n    mask = (c ^ 1) - 1;\n\n    for (i = 0; i < 10; i++) {\n      g[i] &= mask;\n    }\n\n    mask = ~mask;\n\n    for (i = 0; i < 10; i++) {\n      this._h[i] = this._h[i] & mask | g[i];\n    }\n\n    this._h[0] = (this._h[0] | this._h[1] << 13) & 0xffff;\n    this._h[1] = (this._h[1] >>> 3 | this._h[2] << 10) & 0xffff;\n    this._h[2] = (this._h[2] >>> 6 | this._h[3] << 7) & 0xffff;\n    this._h[3] = (this._h[3] >>> 9 | this._h[4] << 4) & 0xffff;\n    this._h[4] = (this._h[4] >>> 12 | this._h[5] << 1 | this._h[6] << 14) & 0xffff;\n    this._h[5] = (this._h[6] >>> 2 | this._h[7] << 11) & 0xffff;\n    this._h[6] = (this._h[7] >>> 5 | this._h[8] << 8) & 0xffff;\n    this._h[7] = (this._h[8] >>> 8 | this._h[9] << 5) & 0xffff;\n    f = this._h[0] + this._pad[0];\n    this._h[0] = f & 0xffff;\n\n    for (i = 1; i < 8; i++) {\n      f = (this._h[i] + this._pad[i] | 0) + (f >>> 16) | 0;\n      this._h[i] = f & 0xffff;\n    }\n\n    mac[macpos + 0] = this._h[0] >>> 0;\n    mac[macpos + 1] = this._h[0] >>> 8;\n    mac[macpos + 2] = this._h[1] >>> 0;\n    mac[macpos + 3] = this._h[1] >>> 8;\n    mac[macpos + 4] = this._h[2] >>> 0;\n    mac[macpos + 5] = this._h[2] >>> 8;\n    mac[macpos + 6] = this._h[3] >>> 0;\n    mac[macpos + 7] = this._h[3] >>> 8;\n    mac[macpos + 8] = this._h[4] >>> 0;\n    mac[macpos + 9] = this._h[4] >>> 8;\n    mac[macpos + 10] = this._h[5] >>> 0;\n    mac[macpos + 11] = this._h[5] >>> 8;\n    mac[macpos + 12] = this._h[6] >>> 0;\n    mac[macpos + 13] = this._h[6] >>> 8;\n    mac[macpos + 14] = this._h[7] >>> 0;\n    mac[macpos + 15] = this._h[7] >>> 8;\n    this._finished = true;\n    return this;\n  };\n\n  Poly1305.prototype.update = function (m) {\n    var mpos = 0;\n    var bytes = m.length;\n    var want;\n\n    if (this._leftover) {\n      want = 16 - this._leftover;\n\n      if (want > bytes) {\n        want = bytes;\n      }\n\n      for (var i = 0; i < want; i++) {\n        this._buffer[this._leftover + i] = m[mpos + i];\n      }\n\n      bytes -= want;\n      mpos += want;\n      this._leftover += want;\n\n      if (this._leftover < 16) {\n        return this;\n      }\n\n      this._blocks(this._buffer, 0, 16);\n\n      this._leftover = 0;\n    }\n\n    if (bytes >= 16) {\n      want = bytes - bytes % 16;\n\n      this._blocks(m, mpos, want);\n\n      mpos += want;\n      bytes -= want;\n    }\n\n    if (bytes) {\n      for (var i = 0; i < bytes; i++) {\n        this._buffer[this._leftover + i] = m[mpos + i];\n      }\n\n      this._leftover += bytes;\n    }\n\n    return this;\n  };\n\n  Poly1305.prototype.digest = function () {\n    // TODO(dchest): it behaves differently than other hashes/HMAC,\n    // because it throws when finished — others just return saved result.\n    if (this._finished) {\n      throw new Error(\"Poly1305 was finished\");\n    }\n\n    var mac = new Uint8Array(16);\n    this.finish(mac);\n    return mac;\n  };\n\n  Poly1305.prototype.clean = function () {\n    wipe_1.wipe(this._buffer);\n    wipe_1.wipe(this._r);\n    wipe_1.wipe(this._h);\n    wipe_1.wipe(this._pad);\n    this._leftover = 0;\n    this._fin = 0;\n    this._finished = true; // mark as finished even if not\n\n    return this;\n  };\n\n  return Poly1305;\n}();\n\nexports.Poly1305 = Poly1305;\n/**\n * Returns 16-byte authenticator of data using a one-time 32-byte key.\n *\n * Important: key should be used for only one message, it should never repeat.\n */\n\nfunction oneTimeAuth(key, data) {\n  var h = new Poly1305(key);\n  h.update(data);\n  var digest = h.digest();\n  h.clean();\n  return digest;\n}\n\nexports.oneTimeAuth = oneTimeAuth;\n/**\n * Returns true if two authenticators are 16-byte long and equal.\n * Uses contant-time comparison to avoid leaking timing information.\n */\n\nfunction equal(a, b) {\n  if (a.length !== exports.DIGEST_LENGTH || b.length !== exports.DIGEST_LENGTH) {\n    return false;\n  }\n\n  return constant_time_1.equal(a, b);\n}\n\nexports.equal = equal;","map":{"version":3,"sources":["../poly1305.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\n// Copyright (C) 2016 Dmitry Chestnykh\n// MIT License. See LICENSE file for details.\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Package poly1305 implements Poly1305 one-time message authentication algorithm.\n */\nvar constant_time_1 = require(\"@stablelib/constant-time\");\nvar wipe_1 = require(\"@stablelib/wipe\");\nexports.DIGEST_LENGTH = 16;\n// Port of Andrew Moon's Poly1305-donna-16. Public domain.\n// https://github.com/floodyberry/poly1305-donna\n/**\n * Poly1305 computes 16-byte authenticator of message using\n * a one-time 32-byte key.\n *\n * Important: key should be used for only one message,\n * it should never repeat.\n */\nvar Poly1305 = /** @class */ (function () {\n    function Poly1305(key) {\n        this.digestLength = exports.DIGEST_LENGTH;\n        this._buffer = new Uint8Array(16);\n        this._r = new Uint16Array(10);\n        this._h = new Uint16Array(10);\n        this._pad = new Uint16Array(8);\n        this._leftover = 0;\n        this._fin = 0;\n        this._finished = false;\n        var t0 = key[0] | key[1] << 8;\n        this._r[0] = (t0) & 0x1fff;\n        var t1 = key[2] | key[3] << 8;\n        this._r[1] = ((t0 >>> 13) | (t1 << 3)) & 0x1fff;\n        var t2 = key[4] | key[5] << 8;\n        this._r[2] = ((t1 >>> 10) | (t2 << 6)) & 0x1f03;\n        var t3 = key[6] | key[7] << 8;\n        this._r[3] = ((t2 >>> 7) | (t3 << 9)) & 0x1fff;\n        var t4 = key[8] | key[9] << 8;\n        this._r[4] = ((t3 >>> 4) | (t4 << 12)) & 0x00ff;\n        this._r[5] = ((t4 >>> 1)) & 0x1ffe;\n        var t5 = key[10] | key[11] << 8;\n        this._r[6] = ((t4 >>> 14) | (t5 << 2)) & 0x1fff;\n        var t6 = key[12] | key[13] << 8;\n        this._r[7] = ((t5 >>> 11) | (t6 << 5)) & 0x1f81;\n        var t7 = key[14] | key[15] << 8;\n        this._r[8] = ((t6 >>> 8) | (t7 << 8)) & 0x1fff;\n        this._r[9] = ((t7 >>> 5)) & 0x007f;\n        this._pad[0] = key[16] | key[17] << 8;\n        this._pad[1] = key[18] | key[19] << 8;\n        this._pad[2] = key[20] | key[21] << 8;\n        this._pad[3] = key[22] | key[23] << 8;\n        this._pad[4] = key[24] | key[25] << 8;\n        this._pad[5] = key[26] | key[27] << 8;\n        this._pad[6] = key[28] | key[29] << 8;\n        this._pad[7] = key[30] | key[31] << 8;\n    }\n    Poly1305.prototype._blocks = function (m, mpos, bytes) {\n        var hibit = this._fin ? 0 : 1 << 11;\n        var h0 = this._h[0], h1 = this._h[1], h2 = this._h[2], h3 = this._h[3], h4 = this._h[4], h5 = this._h[5], h6 = this._h[6], h7 = this._h[7], h8 = this._h[8], h9 = this._h[9];\n        var r0 = this._r[0], r1 = this._r[1], r2 = this._r[2], r3 = this._r[3], r4 = this._r[4], r5 = this._r[5], r6 = this._r[6], r7 = this._r[7], r8 = this._r[8], r9 = this._r[9];\n        while (bytes >= 16) {\n            var t0 = m[mpos + 0] | m[mpos + 1] << 8;\n            h0 += (t0) & 0x1fff;\n            var t1 = m[mpos + 2] | m[mpos + 3] << 8;\n            h1 += ((t0 >>> 13) | (t1 << 3)) & 0x1fff;\n            var t2 = m[mpos + 4] | m[mpos + 5] << 8;\n            h2 += ((t1 >>> 10) | (t2 << 6)) & 0x1fff;\n            var t3 = m[mpos + 6] | m[mpos + 7] << 8;\n            h3 += ((t2 >>> 7) | (t3 << 9)) & 0x1fff;\n            var t4 = m[mpos + 8] | m[mpos + 9] << 8;\n            h4 += ((t3 >>> 4) | (t4 << 12)) & 0x1fff;\n            h5 += ((t4 >>> 1)) & 0x1fff;\n            var t5 = m[mpos + 10] | m[mpos + 11] << 8;\n            h6 += ((t4 >>> 14) | (t5 << 2)) & 0x1fff;\n            var t6 = m[mpos + 12] | m[mpos + 13] << 8;\n            h7 += ((t5 >>> 11) | (t6 << 5)) & 0x1fff;\n            var t7 = m[mpos + 14] | m[mpos + 15] << 8;\n            h8 += ((t6 >>> 8) | (t7 << 8)) & 0x1fff;\n            h9 += ((t7 >>> 5)) | hibit;\n            var c = 0;\n            var d0 = c;\n            d0 += h0 * r0;\n            d0 += h1 * (5 * r9);\n            d0 += h2 * (5 * r8);\n            d0 += h3 * (5 * r7);\n            d0 += h4 * (5 * r6);\n            c = (d0 >>> 13);\n            d0 &= 0x1fff;\n            d0 += h5 * (5 * r5);\n            d0 += h6 * (5 * r4);\n            d0 += h7 * (5 * r3);\n            d0 += h8 * (5 * r2);\n            d0 += h9 * (5 * r1);\n            c += (d0 >>> 13);\n            d0 &= 0x1fff;\n            var d1 = c;\n            d1 += h0 * r1;\n            d1 += h1 * r0;\n            d1 += h2 * (5 * r9);\n            d1 += h3 * (5 * r8);\n            d1 += h4 * (5 * r7);\n            c = (d1 >>> 13);\n            d1 &= 0x1fff;\n            d1 += h5 * (5 * r6);\n            d1 += h6 * (5 * r5);\n            d1 += h7 * (5 * r4);\n            d1 += h8 * (5 * r3);\n            d1 += h9 * (5 * r2);\n            c += (d1 >>> 13);\n            d1 &= 0x1fff;\n            var d2 = c;\n            d2 += h0 * r2;\n            d2 += h1 * r1;\n            d2 += h2 * r0;\n            d2 += h3 * (5 * r9);\n            d2 += h4 * (5 * r8);\n            c = (d2 >>> 13);\n            d2 &= 0x1fff;\n            d2 += h5 * (5 * r7);\n            d2 += h6 * (5 * r6);\n            d2 += h7 * (5 * r5);\n            d2 += h8 * (5 * r4);\n            d2 += h9 * (5 * r3);\n            c += (d2 >>> 13);\n            d2 &= 0x1fff;\n            var d3 = c;\n            d3 += h0 * r3;\n            d3 += h1 * r2;\n            d3 += h2 * r1;\n            d3 += h3 * r0;\n            d3 += h4 * (5 * r9);\n            c = (d3 >>> 13);\n            d3 &= 0x1fff;\n            d3 += h5 * (5 * r8);\n            d3 += h6 * (5 * r7);\n            d3 += h7 * (5 * r6);\n            d3 += h8 * (5 * r5);\n            d3 += h9 * (5 * r4);\n            c += (d3 >>> 13);\n            d3 &= 0x1fff;\n            var d4 = c;\n            d4 += h0 * r4;\n            d4 += h1 * r3;\n            d4 += h2 * r2;\n            d4 += h3 * r1;\n            d4 += h4 * r0;\n            c = (d4 >>> 13);\n            d4 &= 0x1fff;\n            d4 += h5 * (5 * r9);\n            d4 += h6 * (5 * r8);\n            d4 += h7 * (5 * r7);\n            d4 += h8 * (5 * r6);\n            d4 += h9 * (5 * r5);\n            c += (d4 >>> 13);\n            d4 &= 0x1fff;\n            var d5 = c;\n            d5 += h0 * r5;\n            d5 += h1 * r4;\n            d5 += h2 * r3;\n            d5 += h3 * r2;\n            d5 += h4 * r1;\n            c = (d5 >>> 13);\n            d5 &= 0x1fff;\n            d5 += h5 * r0;\n            d5 += h6 * (5 * r9);\n            d5 += h7 * (5 * r8);\n            d5 += h8 * (5 * r7);\n            d5 += h9 * (5 * r6);\n            c += (d5 >>> 13);\n            d5 &= 0x1fff;\n            var d6 = c;\n            d6 += h0 * r6;\n            d6 += h1 * r5;\n            d6 += h2 * r4;\n            d6 += h3 * r3;\n            d6 += h4 * r2;\n            c = (d6 >>> 13);\n            d6 &= 0x1fff;\n            d6 += h5 * r1;\n            d6 += h6 * r0;\n            d6 += h7 * (5 * r9);\n            d6 += h8 * (5 * r8);\n            d6 += h9 * (5 * r7);\n            c += (d6 >>> 13);\n            d6 &= 0x1fff;\n            var d7 = c;\n            d7 += h0 * r7;\n            d7 += h1 * r6;\n            d7 += h2 * r5;\n            d7 += h3 * r4;\n            d7 += h4 * r3;\n            c = (d7 >>> 13);\n            d7 &= 0x1fff;\n            d7 += h5 * r2;\n            d7 += h6 * r1;\n            d7 += h7 * r0;\n            d7 += h8 * (5 * r9);\n            d7 += h9 * (5 * r8);\n            c += (d7 >>> 13);\n            d7 &= 0x1fff;\n            var d8 = c;\n            d8 += h0 * r8;\n            d8 += h1 * r7;\n            d8 += h2 * r6;\n            d8 += h3 * r5;\n            d8 += h4 * r4;\n            c = (d8 >>> 13);\n            d8 &= 0x1fff;\n            d8 += h5 * r3;\n            d8 += h6 * r2;\n            d8 += h7 * r1;\n            d8 += h8 * r0;\n            d8 += h9 * (5 * r9);\n            c += (d8 >>> 13);\n            d8 &= 0x1fff;\n            var d9 = c;\n            d9 += h0 * r9;\n            d9 += h1 * r8;\n            d9 += h2 * r7;\n            d9 += h3 * r6;\n            d9 += h4 * r5;\n            c = (d9 >>> 13);\n            d9 &= 0x1fff;\n            d9 += h5 * r4;\n            d9 += h6 * r3;\n            d9 += h7 * r2;\n            d9 += h8 * r1;\n            d9 += h9 * r0;\n            c += (d9 >>> 13);\n            d9 &= 0x1fff;\n            c = (((c << 2) + c)) | 0;\n            c = (c + d0) | 0;\n            d0 = c & 0x1fff;\n            c = (c >>> 13);\n            d1 += c;\n            h0 = d0;\n            h1 = d1;\n            h2 = d2;\n            h3 = d3;\n            h4 = d4;\n            h5 = d5;\n            h6 = d6;\n            h7 = d7;\n            h8 = d8;\n            h9 = d9;\n            mpos += 16;\n            bytes -= 16;\n        }\n        this._h[0] = h0;\n        this._h[1] = h1;\n        this._h[2] = h2;\n        this._h[3] = h3;\n        this._h[4] = h4;\n        this._h[5] = h5;\n        this._h[6] = h6;\n        this._h[7] = h7;\n        this._h[8] = h8;\n        this._h[9] = h9;\n    };\n    Poly1305.prototype.finish = function (mac, macpos) {\n        if (macpos === void 0) { macpos = 0; }\n        var g = new Uint16Array(10);\n        var c;\n        var mask;\n        var f;\n        var i;\n        if (this._leftover) {\n            i = this._leftover;\n            this._buffer[i++] = 1;\n            for (; i < 16; i++) {\n                this._buffer[i] = 0;\n            }\n            this._fin = 1;\n            this._blocks(this._buffer, 0, 16);\n        }\n        c = this._h[1] >>> 13;\n        this._h[1] &= 0x1fff;\n        for (i = 2; i < 10; i++) {\n            this._h[i] += c;\n            c = this._h[i] >>> 13;\n            this._h[i] &= 0x1fff;\n        }\n        this._h[0] += (c * 5);\n        c = this._h[0] >>> 13;\n        this._h[0] &= 0x1fff;\n        this._h[1] += c;\n        c = this._h[1] >>> 13;\n        this._h[1] &= 0x1fff;\n        this._h[2] += c;\n        g[0] = this._h[0] + 5;\n        c = g[0] >>> 13;\n        g[0] &= 0x1fff;\n        for (i = 1; i < 10; i++) {\n            g[i] = this._h[i] + c;\n            c = g[i] >>> 13;\n            g[i] &= 0x1fff;\n        }\n        g[9] -= (1 << 13);\n        mask = (c ^ 1) - 1;\n        for (i = 0; i < 10; i++) {\n            g[i] &= mask;\n        }\n        mask = ~mask;\n        for (i = 0; i < 10; i++) {\n            this._h[i] = (this._h[i] & mask) | g[i];\n        }\n        this._h[0] = ((this._h[0]) | (this._h[1] << 13)) & 0xffff;\n        this._h[1] = ((this._h[1] >>> 3) | (this._h[2] << 10)) & 0xffff;\n        this._h[2] = ((this._h[2] >>> 6) | (this._h[3] << 7)) & 0xffff;\n        this._h[3] = ((this._h[3] >>> 9) | (this._h[4] << 4)) & 0xffff;\n        this._h[4] = ((this._h[4] >>> 12) | (this._h[5] << 1) | (this._h[6] << 14)) & 0xffff;\n        this._h[5] = ((this._h[6] >>> 2) | (this._h[7] << 11)) & 0xffff;\n        this._h[6] = ((this._h[7] >>> 5) | (this._h[8] << 8)) & 0xffff;\n        this._h[7] = ((this._h[8] >>> 8) | (this._h[9] << 5)) & 0xffff;\n        f = this._h[0] + this._pad[0];\n        this._h[0] = f & 0xffff;\n        for (i = 1; i < 8; i++) {\n            f = (((this._h[i] + this._pad[i]) | 0) + (f >>> 16)) | 0;\n            this._h[i] = f & 0xffff;\n        }\n        mac[macpos + 0] = this._h[0] >>> 0;\n        mac[macpos + 1] = this._h[0] >>> 8;\n        mac[macpos + 2] = this._h[1] >>> 0;\n        mac[macpos + 3] = this._h[1] >>> 8;\n        mac[macpos + 4] = this._h[2] >>> 0;\n        mac[macpos + 5] = this._h[2] >>> 8;\n        mac[macpos + 6] = this._h[3] >>> 0;\n        mac[macpos + 7] = this._h[3] >>> 8;\n        mac[macpos + 8] = this._h[4] >>> 0;\n        mac[macpos + 9] = this._h[4] >>> 8;\n        mac[macpos + 10] = this._h[5] >>> 0;\n        mac[macpos + 11] = this._h[5] >>> 8;\n        mac[macpos + 12] = this._h[6] >>> 0;\n        mac[macpos + 13] = this._h[6] >>> 8;\n        mac[macpos + 14] = this._h[7] >>> 0;\n        mac[macpos + 15] = this._h[7] >>> 8;\n        this._finished = true;\n        return this;\n    };\n    Poly1305.prototype.update = function (m) {\n        var mpos = 0;\n        var bytes = m.length;\n        var want;\n        if (this._leftover) {\n            want = (16 - this._leftover);\n            if (want > bytes) {\n                want = bytes;\n            }\n            for (var i = 0; i < want; i++) {\n                this._buffer[this._leftover + i] = m[mpos + i];\n            }\n            bytes -= want;\n            mpos += want;\n            this._leftover += want;\n            if (this._leftover < 16) {\n                return this;\n            }\n            this._blocks(this._buffer, 0, 16);\n            this._leftover = 0;\n        }\n        if (bytes >= 16) {\n            want = bytes - (bytes % 16);\n            this._blocks(m, mpos, want);\n            mpos += want;\n            bytes -= want;\n        }\n        if (bytes) {\n            for (var i = 0; i < bytes; i++) {\n                this._buffer[this._leftover + i] = m[mpos + i];\n            }\n            this._leftover += bytes;\n        }\n        return this;\n    };\n    Poly1305.prototype.digest = function () {\n        // TODO(dchest): it behaves differently than other hashes/HMAC,\n        // because it throws when finished — others just return saved result.\n        if (this._finished) {\n            throw new Error(\"Poly1305 was finished\");\n        }\n        var mac = new Uint8Array(16);\n        this.finish(mac);\n        return mac;\n    };\n    Poly1305.prototype.clean = function () {\n        wipe_1.wipe(this._buffer);\n        wipe_1.wipe(this._r);\n        wipe_1.wipe(this._h);\n        wipe_1.wipe(this._pad);\n        this._leftover = 0;\n        this._fin = 0;\n        this._finished = true; // mark as finished even if not\n        return this;\n    };\n    return Poly1305;\n}());\nexports.Poly1305 = Poly1305;\n/**\n * Returns 16-byte authenticator of data using a one-time 32-byte key.\n *\n * Important: key should be used for only one message, it should never repeat.\n */\nfunction oneTimeAuth(key, data) {\n    var h = new Poly1305(key);\n    h.update(data);\n    var digest = h.digest();\n    h.clean();\n    return digest;\n}\nexports.oneTimeAuth = oneTimeAuth;\n/**\n * Returns true if two authenticators are 16-byte long and equal.\n * Uses contant-time comparison to avoid leaking timing information.\n */\nfunction equal(a, b) {\n    if (a.length !== exports.DIGEST_LENGTH || b.length !== exports.DIGEST_LENGTH) {\n        return false;\n    }\n    return constant_time_1.equal(a, b);\n}\nexports.equal = equal;\n//# sourceMappingURL=poly1305.js.map"]},"metadata":{},"sourceType":"script"}