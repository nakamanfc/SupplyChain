{"ast":null,"code":"\"use strict\"; // Copyright (C) 2016 Dmitry Chestnykh\n// MIT License. See LICENSE file for details.\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar binary_1 = require(\"@stablelib/binary\");\n\nvar wipe_1 = require(\"@stablelib/wipe\");\n\nexports.DIGEST_LENGTH = 32;\nexports.BLOCK_SIZE = 64;\n/**\n * SHA2-256 cryptographic hash algorithm.\n */\n\nvar SHA256 =\n/** @class */\nfunction () {\n  function SHA256() {\n    /** Length of hash output */\n    this.digestLength = exports.DIGEST_LENGTH;\n    /** Block size */\n\n    this.blockSize = exports.BLOCK_SIZE; // Note: Int32Array is used instead of Uint32Array for performance reasons.\n\n    this._state = new Int32Array(8); // hash state\n\n    this._temp = new Int32Array(64); // temporary state\n\n    this._buffer = new Uint8Array(128); // buffer for data to hash\n\n    this._bufferLength = 0; // number of bytes in buffer\n\n    this._bytesHashed = 0; // number of total bytes hashed\n\n    this._finished = false; // indicates whether the hash was finalized\n\n    this.reset();\n  }\n\n  SHA256.prototype._initState = function () {\n    this._state[0] = 0x6a09e667;\n    this._state[1] = 0xbb67ae85;\n    this._state[2] = 0x3c6ef372;\n    this._state[3] = 0xa54ff53a;\n    this._state[4] = 0x510e527f;\n    this._state[5] = 0x9b05688c;\n    this._state[6] = 0x1f83d9ab;\n    this._state[7] = 0x5be0cd19;\n  };\n  /**\n   * Resets hash state making it possible\n   * to re-use this instance to hash other data.\n   */\n\n\n  SHA256.prototype.reset = function () {\n    this._initState();\n\n    this._bufferLength = 0;\n    this._bytesHashed = 0;\n    this._finished = false;\n    return this;\n  };\n  /**\n   * Cleans internal buffers and resets hash state.\n   */\n\n\n  SHA256.prototype.clean = function () {\n    wipe_1.wipe(this._buffer);\n    wipe_1.wipe(this._temp);\n    this.reset();\n  };\n  /**\n   * Updates hash state with the given data.\n   *\n   * Throws error when trying to update already finalized hash:\n   * instance must be reset to update it again.\n   */\n\n\n  SHA256.prototype.update = function (data, dataLength) {\n    if (dataLength === void 0) {\n      dataLength = data.length;\n    }\n\n    if (this._finished) {\n      throw new Error(\"SHA256: can't update because hash was finished.\");\n    }\n\n    var dataPos = 0;\n    this._bytesHashed += dataLength;\n\n    if (this._bufferLength > 0) {\n      while (this._bufferLength < this.blockSize && dataLength > 0) {\n        this._buffer[this._bufferLength++] = data[dataPos++];\n        dataLength--;\n      }\n\n      if (this._bufferLength === this.blockSize) {\n        hashBlocks(this._temp, this._state, this._buffer, 0, this.blockSize);\n        this._bufferLength = 0;\n      }\n    }\n\n    if (dataLength >= this.blockSize) {\n      dataPos = hashBlocks(this._temp, this._state, data, dataPos, dataLength);\n      dataLength %= this.blockSize;\n    }\n\n    while (dataLength > 0) {\n      this._buffer[this._bufferLength++] = data[dataPos++];\n      dataLength--;\n    }\n\n    return this;\n  };\n  /**\n   * Finalizes hash state and puts hash into out.\n   * If hash was already finalized, puts the same value.\n   */\n\n\n  SHA256.prototype.finish = function (out) {\n    if (!this._finished) {\n      var bytesHashed = this._bytesHashed;\n      var left = this._bufferLength;\n      var bitLenHi = bytesHashed / 0x20000000 | 0;\n      var bitLenLo = bytesHashed << 3;\n      var padLength = bytesHashed % 64 < 56 ? 64 : 128;\n      this._buffer[left] = 0x80;\n\n      for (var i = left + 1; i < padLength - 8; i++) {\n        this._buffer[i] = 0;\n      }\n\n      binary_1.writeUint32BE(bitLenHi, this._buffer, padLength - 8);\n      binary_1.writeUint32BE(bitLenLo, this._buffer, padLength - 4);\n      hashBlocks(this._temp, this._state, this._buffer, 0, padLength);\n      this._finished = true;\n    }\n\n    for (var i = 0; i < this.digestLength / 4; i++) {\n      binary_1.writeUint32BE(this._state[i], out, i * 4);\n    }\n\n    return this;\n  };\n  /**\n   * Returns the final hash digest.\n   */\n\n\n  SHA256.prototype.digest = function () {\n    var out = new Uint8Array(this.digestLength);\n    this.finish(out);\n    return out;\n  };\n  /**\n   * Function useful for HMAC/PBKDF2 optimization.\n   * Returns hash state to be used with restoreState().\n   * Only chain value is saved, not buffers or other\n   * state variables.\n   */\n\n\n  SHA256.prototype.saveState = function () {\n    if (this._finished) {\n      throw new Error(\"SHA256: cannot save finished state\");\n    }\n\n    return {\n      state: new Int32Array(this._state),\n      buffer: this._bufferLength > 0 ? new Uint8Array(this._buffer) : undefined,\n      bufferLength: this._bufferLength,\n      bytesHashed: this._bytesHashed\n    };\n  };\n  /**\n   * Function useful for HMAC/PBKDF2 optimization.\n   * Restores state saved by saveState() and sets bytesHashed\n   * to the given value.\n   */\n\n\n  SHA256.prototype.restoreState = function (savedState) {\n    this._state.set(savedState.state);\n\n    this._bufferLength = savedState.bufferLength;\n\n    if (savedState.buffer) {\n      this._buffer.set(savedState.buffer);\n    }\n\n    this._bytesHashed = savedState.bytesHashed;\n    this._finished = false;\n    return this;\n  };\n  /**\n   * Cleans state returned by saveState().\n   */\n\n\n  SHA256.prototype.cleanSavedState = function (savedState) {\n    wipe_1.wipe(savedState.state);\n\n    if (savedState.buffer) {\n      wipe_1.wipe(savedState.buffer);\n    }\n\n    savedState.bufferLength = 0;\n    savedState.bytesHashed = 0;\n  };\n\n  return SHA256;\n}();\n\nexports.SHA256 = SHA256; // Constants\n\nvar K = new Int32Array([0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5, 0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174, 0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da, 0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967, 0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85, 0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070, 0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3, 0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2]);\n\nfunction hashBlocks(w, v, p, pos, len) {\n  while (len >= 64) {\n    var a = v[0];\n    var b = v[1];\n    var c = v[2];\n    var d = v[3];\n    var e = v[4];\n    var f = v[5];\n    var g = v[6];\n    var h = v[7];\n\n    for (var i = 0; i < 16; i++) {\n      var j = pos + i * 4;\n      w[i] = binary_1.readUint32BE(p, j);\n    }\n\n    for (var i = 16; i < 64; i++) {\n      var u = w[i - 2];\n      var t1 = (u >>> 17 | u << 32 - 17) ^ (u >>> 19 | u << 32 - 19) ^ u >>> 10;\n      u = w[i - 15];\n      var t2 = (u >>> 7 | u << 32 - 7) ^ (u >>> 18 | u << 32 - 18) ^ u >>> 3;\n      w[i] = (t1 + w[i - 7] | 0) + (t2 + w[i - 16] | 0);\n    }\n\n    for (var i = 0; i < 64; i++) {\n      var t1 = (((e >>> 6 | e << 32 - 6) ^ (e >>> 11 | e << 32 - 11) ^ (e >>> 25 | e << 32 - 25)) + (e & f ^ ~e & g) | 0) + (h + (K[i] + w[i] | 0) | 0) | 0;\n      var t2 = ((a >>> 2 | a << 32 - 2) ^ (a >>> 13 | a << 32 - 13) ^ (a >>> 22 | a << 32 - 22)) + (a & b ^ a & c ^ b & c) | 0;\n      h = g;\n      g = f;\n      f = e;\n      e = d + t1 | 0;\n      d = c;\n      c = b;\n      b = a;\n      a = t1 + t2 | 0;\n    }\n\n    v[0] += a;\n    v[1] += b;\n    v[2] += c;\n    v[3] += d;\n    v[4] += e;\n    v[5] += f;\n    v[6] += g;\n    v[7] += h;\n    pos += 64;\n    len -= 64;\n  }\n\n  return pos;\n}\n\nfunction hash(data) {\n  var h = new SHA256();\n  h.update(data);\n  var digest = h.digest();\n  h.clean();\n  return digest;\n}\n\nexports.hash = hash;","map":{"version":3,"sources":["../sha256.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\n// Copyright (C) 2016 Dmitry Chestnykh\n// MIT License. See LICENSE file for details.\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar binary_1 = require(\"@stablelib/binary\");\nvar wipe_1 = require(\"@stablelib/wipe\");\nexports.DIGEST_LENGTH = 32;\nexports.BLOCK_SIZE = 64;\n/**\n * SHA2-256 cryptographic hash algorithm.\n */\nvar SHA256 = /** @class */ (function () {\n    function SHA256() {\n        /** Length of hash output */\n        this.digestLength = exports.DIGEST_LENGTH;\n        /** Block size */\n        this.blockSize = exports.BLOCK_SIZE;\n        // Note: Int32Array is used instead of Uint32Array for performance reasons.\n        this._state = new Int32Array(8); // hash state\n        this._temp = new Int32Array(64); // temporary state\n        this._buffer = new Uint8Array(128); // buffer for data to hash\n        this._bufferLength = 0; // number of bytes in buffer\n        this._bytesHashed = 0; // number of total bytes hashed\n        this._finished = false; // indicates whether the hash was finalized\n        this.reset();\n    }\n    SHA256.prototype._initState = function () {\n        this._state[0] = 0x6a09e667;\n        this._state[1] = 0xbb67ae85;\n        this._state[2] = 0x3c6ef372;\n        this._state[3] = 0xa54ff53a;\n        this._state[4] = 0x510e527f;\n        this._state[5] = 0x9b05688c;\n        this._state[6] = 0x1f83d9ab;\n        this._state[7] = 0x5be0cd19;\n    };\n    /**\n     * Resets hash state making it possible\n     * to re-use this instance to hash other data.\n     */\n    SHA256.prototype.reset = function () {\n        this._initState();\n        this._bufferLength = 0;\n        this._bytesHashed = 0;\n        this._finished = false;\n        return this;\n    };\n    /**\n     * Cleans internal buffers and resets hash state.\n     */\n    SHA256.prototype.clean = function () {\n        wipe_1.wipe(this._buffer);\n        wipe_1.wipe(this._temp);\n        this.reset();\n    };\n    /**\n     * Updates hash state with the given data.\n     *\n     * Throws error when trying to update already finalized hash:\n     * instance must be reset to update it again.\n     */\n    SHA256.prototype.update = function (data, dataLength) {\n        if (dataLength === void 0) { dataLength = data.length; }\n        if (this._finished) {\n            throw new Error(\"SHA256: can't update because hash was finished.\");\n        }\n        var dataPos = 0;\n        this._bytesHashed += dataLength;\n        if (this._bufferLength > 0) {\n            while (this._bufferLength < this.blockSize && dataLength > 0) {\n                this._buffer[this._bufferLength++] = data[dataPos++];\n                dataLength--;\n            }\n            if (this._bufferLength === this.blockSize) {\n                hashBlocks(this._temp, this._state, this._buffer, 0, this.blockSize);\n                this._bufferLength = 0;\n            }\n        }\n        if (dataLength >= this.blockSize) {\n            dataPos = hashBlocks(this._temp, this._state, data, dataPos, dataLength);\n            dataLength %= this.blockSize;\n        }\n        while (dataLength > 0) {\n            this._buffer[this._bufferLength++] = data[dataPos++];\n            dataLength--;\n        }\n        return this;\n    };\n    /**\n     * Finalizes hash state and puts hash into out.\n     * If hash was already finalized, puts the same value.\n     */\n    SHA256.prototype.finish = function (out) {\n        if (!this._finished) {\n            var bytesHashed = this._bytesHashed;\n            var left = this._bufferLength;\n            var bitLenHi = (bytesHashed / 0x20000000) | 0;\n            var bitLenLo = bytesHashed << 3;\n            var padLength = (bytesHashed % 64 < 56) ? 64 : 128;\n            this._buffer[left] = 0x80;\n            for (var i = left + 1; i < padLength - 8; i++) {\n                this._buffer[i] = 0;\n            }\n            binary_1.writeUint32BE(bitLenHi, this._buffer, padLength - 8);\n            binary_1.writeUint32BE(bitLenLo, this._buffer, padLength - 4);\n            hashBlocks(this._temp, this._state, this._buffer, 0, padLength);\n            this._finished = true;\n        }\n        for (var i = 0; i < this.digestLength / 4; i++) {\n            binary_1.writeUint32BE(this._state[i], out, i * 4);\n        }\n        return this;\n    };\n    /**\n     * Returns the final hash digest.\n     */\n    SHA256.prototype.digest = function () {\n        var out = new Uint8Array(this.digestLength);\n        this.finish(out);\n        return out;\n    };\n    /**\n     * Function useful for HMAC/PBKDF2 optimization.\n     * Returns hash state to be used with restoreState().\n     * Only chain value is saved, not buffers or other\n     * state variables.\n     */\n    SHA256.prototype.saveState = function () {\n        if (this._finished) {\n            throw new Error(\"SHA256: cannot save finished state\");\n        }\n        return {\n            state: new Int32Array(this._state),\n            buffer: this._bufferLength > 0 ? new Uint8Array(this._buffer) : undefined,\n            bufferLength: this._bufferLength,\n            bytesHashed: this._bytesHashed\n        };\n    };\n    /**\n     * Function useful for HMAC/PBKDF2 optimization.\n     * Restores state saved by saveState() and sets bytesHashed\n     * to the given value.\n     */\n    SHA256.prototype.restoreState = function (savedState) {\n        this._state.set(savedState.state);\n        this._bufferLength = savedState.bufferLength;\n        if (savedState.buffer) {\n            this._buffer.set(savedState.buffer);\n        }\n        this._bytesHashed = savedState.bytesHashed;\n        this._finished = false;\n        return this;\n    };\n    /**\n     * Cleans state returned by saveState().\n     */\n    SHA256.prototype.cleanSavedState = function (savedState) {\n        wipe_1.wipe(savedState.state);\n        if (savedState.buffer) {\n            wipe_1.wipe(savedState.buffer);\n        }\n        savedState.bufferLength = 0;\n        savedState.bytesHashed = 0;\n    };\n    return SHA256;\n}());\nexports.SHA256 = SHA256;\n// Constants\nvar K = new Int32Array([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b,\n    0x59f111f1, 0x923f82a4, 0xab1c5ed5, 0xd807aa98, 0x12835b01,\n    0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7,\n    0xc19bf174, 0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc,\n    0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da, 0x983e5152,\n    0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147,\n    0x06ca6351, 0x14292967, 0x27b70a85, 0x2e1b2138, 0x4d2c6dfc,\n    0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819,\n    0xd6990624, 0xf40e3585, 0x106aa070, 0x19a4c116, 0x1e376c08,\n    0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f,\n    0x682e6ff3, 0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208,\n    0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\nfunction hashBlocks(w, v, p, pos, len) {\n    while (len >= 64) {\n        var a = v[0];\n        var b = v[1];\n        var c = v[2];\n        var d = v[3];\n        var e = v[4];\n        var f = v[5];\n        var g = v[6];\n        var h = v[7];\n        for (var i = 0; i < 16; i++) {\n            var j = pos + i * 4;\n            w[i] = binary_1.readUint32BE(p, j);\n        }\n        for (var i = 16; i < 64; i++) {\n            var u = w[i - 2];\n            var t1 = (u >>> 17 | u << (32 - 17)) ^ (u >>> 19 | u << (32 - 19)) ^ (u >>> 10);\n            u = w[i - 15];\n            var t2 = (u >>> 7 | u << (32 - 7)) ^ (u >>> 18 | u << (32 - 18)) ^ (u >>> 3);\n            w[i] = (t1 + w[i - 7] | 0) + (t2 + w[i - 16] | 0);\n        }\n        for (var i = 0; i < 64; i++) {\n            var t1 = (((((e >>> 6 | e << (32 - 6)) ^ (e >>> 11 | e << (32 - 11)) ^\n                (e >>> 25 | e << (32 - 25))) + ((e & f) ^ (~e & g))) | 0) +\n                ((h + ((K[i] + w[i]) | 0)) | 0)) | 0;\n            var t2 = (((a >>> 2 | a << (32 - 2)) ^ (a >>> 13 | a << (32 - 13)) ^\n                (a >>> 22 | a << (32 - 22))) + ((a & b) ^ (a & c) ^ (b & c))) | 0;\n            h = g;\n            g = f;\n            f = e;\n            e = (d + t1) | 0;\n            d = c;\n            c = b;\n            b = a;\n            a = (t1 + t2) | 0;\n        }\n        v[0] += a;\n        v[1] += b;\n        v[2] += c;\n        v[3] += d;\n        v[4] += e;\n        v[5] += f;\n        v[6] += g;\n        v[7] += h;\n        pos += 64;\n        len -= 64;\n    }\n    return pos;\n}\nfunction hash(data) {\n    var h = new SHA256();\n    h.update(data);\n    var digest = h.digest();\n    h.clean();\n    return digest;\n}\nexports.hash = hash;\n//# sourceMappingURL=sha256.js.map"]},"metadata":{},"sourceType":"script"}